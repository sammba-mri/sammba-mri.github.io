

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>sammba.registration.anats_to_common &mdash; Multimodal Imaging of Neurodegenerative Diseases and Therapies</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="sammba.registration.anats_to_template" href="sammba.registration.anats_to_template.html" />
    <link rel="prev" title="sammba.data_fetchers.fetch_masks_dorr_2008" href="sammba.data_fetchers.fetch_masks_dorr_2008.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> sammba-MRI
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../user_guide.html">User guide: table of contents</a></li>
<li class="toctree-l1"><a class="reference internal" href="../auto_examples/index.html">Gallery of Examples</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../reference.html">sammba-MRI API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../reference.html#module-sammba.io_conversions"><code class="docutils literal"><span class="pre">sammba.io_conversions</span></code>: From scanner to NIFTI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference.html#module-sammba.data_fetchers"><code class="docutils literal"><span class="pre">sammba.data_fetchers</span></code>: Datasets and atlas</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../reference.html#module-sammba.registration"><code class="docutils literal"><span class="pre">sammba.registration</span></code>: Registration utilities</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">sammba.registration.anats_to_common</a></li>
<li class="toctree-l3"><a class="reference internal" href="sammba.registration.anats_to_template.html">sammba.registration.anats_to_template</a></li>
<li class="toctree-l3"><a class="reference internal" href="sammba.registration.fmri_sessions_to_template.html">sammba.registration.fmri_sessions_to_template</a></li>
<li class="toctree-l3"><a class="reference internal" href="sammba.registration.coregister_fmri_session.html">sammba.registration.coregister_fmri_session</a></li>
<li class="toctree-l3"><a class="reference internal" href="sammba.registration.create_pipeline_graph.html">sammba.registration.create_pipeline_graph</a></li>
<li class="toctree-l3"><a class="reference internal" href="sammba.registration.FMRISession.html">sammba.registration.FMRISession</a></li>
<li class="toctree-l3"><a class="reference internal" href="sammba.registration.TemplateRegistrator.html">sammba.registration.TemplateRegistrator</a></li>
<li class="toctree-l3"><a class="reference internal" href="sammba.registration.Coregistrator.html">sammba.registration.Coregistrator</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference.html#module-sammba.segmentation"><code class="docutils literal"><span class="pre">sammba.segmentation</span></code>: Segmentation utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference.html#external-tools-wrapped-in-python">External tools wrapped in python</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../authors.html">Contributors and Acknowledgements</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">sammba-MRI</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../reference.html">sammba-MRI API Reference</a> &raquo;</li>
        
      <li>sammba.registration.anats_to_common</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This page is a reference documentation. It only explains the
function signature, and not how to use it. Please refer to the
<a class="reference internal" href="../user_guide.html#user-guide"><span class="std std-ref">user guide</span></a> for the big picture.</p>
</div>
<div class="section" id="sammba-registration-anats-to-common">
<h1>sammba.registration.anats_to_common<a class="headerlink" href="#sammba-registration-anats-to-common" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="sammba.registration.anats_to_common">
<code class="descclassname">sammba.registration.</code><code class="descname">anats_to_common</code><span class="sig-paren">(</span><em>anat_filenames, write_dir, brain_volume, registration_kind='affine', use_rats_tool=True, nonlinear_levels=[1, 2, 3], nonlinear_minimal_patches=[75], nonlinear_weight_file=None, convergence=0.005, blur_radius_coarse=1.1, caching=False, verbose=1, unifize_kwargs=None, brain_masking_unifize_kwargs=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sammba.registration.anats_to_common" title="Permalink to this definition">¶</a></dt>
<dd><p>Create common template from native anatomical images and achieve
their registration to it.
Parameters
———-
anat_filenames : list of str</p>
<blockquote>
<div>Paths to the anatomical images.</div></blockquote>
<dl class="docutils">
<dt>write_dir <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd>Path to an existant directory to save output files to.</dd>
<dt>brain_volume <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd>Volume of the brain in mm3 used for brain extraction.
Typically 400 for mouse and 1800 for rat.</dd>
<dt>registration_kind <span class="classifier-delimiter">:</span> <span class="classifier">one of {‘rigid’, ‘affine’, ‘nonlinear’}, optional</span></dt>
<dd>The allowed transform kind.</dd>
<dt>use_rats_tool <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd>If True, brain mask is computed using RATS Mathematical Morphology.
Otherwise, a histogram-based brain segmentation is used.</dd>
<dt>nonlinear_levels <span class="classifier-delimiter">:</span> <span class="classifier">list of int, optional</span></dt>
<dd>Maximal levels for each nonlinear warping iteration. Passed iteratively
to sammba.externals.nipype.interfaces.afni.Qwarp</dd>
<dt>nonlinear_minimal_patches <span class="classifier-delimiter">:</span> <span class="classifier">list of int, optional</span></dt>
<dd>Minimal patches for the final nonlinear warps, passed to
sammba.externals.nipype.interfaces.afni.Qwarp</dd>
<dt>nonlinear_weight_file <span class="classifier-delimiter">:</span> <span class="classifier">str, optional</span></dt>
<dd>Path to a mask used to weight non-linear registration. Ideally should 
include not just the whole brain but also extend in all directions to 
include some amount of surrounding head tissue.</dd>
<dt>convergence <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd>Convergence limit, passed to
sammba.externals.nipype.interfaces.afni.Allineate</dd>
<dt>blur_radius_coarse <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd>Radius passed to sammba.externals.nipype.interfaces.afni.Allineate for
the “-twoblur” option</dd>
<dt>caching <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd>If True, caching is used for all the registration steps.</dd>
<dt>verbose <span class="classifier-delimiter">:</span> <span class="classifier">int, optional</span></dt>
<dd>Verbosity level. Note that caching implies some
verbosity in any case.</dd>
<dt>unifize_kwargs <span class="classifier-delimiter">:</span> <span class="classifier">dict, optional</span></dt>
<dd>Is passed to sammba.externals.nipype.interfaces.afni.Unifize, to
control bias correction of the template.</dd>
<dt>brain_masking_unifize_kwargs <span class="classifier-delimiter">:</span> <span class="classifier">dict, optional</span></dt>
<dd>Is passed to sammba.externals.nipype.interfaces.afni.Unifize, to tune
the seperate bias correction step done prior to brain masking.</dd>
</dl>
<dl class="docutils">
<dt>data <span class="classifier-delimiter">:</span> <span class="classifier">sklearn.datasets.base.Bunch</span></dt>
<dd><p class="first">Dictionary-like object, the interest attributes are :
- <cite>registered</cite> : list of str.</p>
<blockquote>
<div>Paths to registered images. Note that
they have undergone a bias correction step before.</div></blockquote>
<ul class="last simple">
<li><dl class="first docutils">
<dt><cite>transforms</cite> <span class="classifier-delimiter">:</span> <span class="classifier">list of str.</span></dt>
<dd>Paths to the transforms from the raw
images to the registered images.</dd>
</dl>
</li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>nonlinear_weight_file:
Without this weight mask, for non-linear registration a mask is generated by 
binarizing the mean of images that have been brain and affine-registered, 
then evenly dilating it to include some surrounding head tissue. The 
non-linear registration is then weighted to work only within this mask. This 
substantially improves performance by 1) reducing the number of voxels to 
analyse, and 2) avoiding other parts of the head where structures are highly 
variable and signal often poor. However, this automatically-generated mask 
is frequently sub-optimal, usually due to missing paraflocculi and 
inappropriate dilation.</p>
<p>Of course, it is impossible to know ahead of time where to weight the image 
before the brains/heads have been registered to each other. So in practice a 
first running of this script is done up until and including the affine stage 
(the default). The user should then manually use 3dmask_tool or some other 
software tool to create an intersect/frac/union mask of the 
_Unifized_for_brain_extraction_masked_resample_shr_affine_catenated files. 
These can then be dilated as needed to include some surrounding head tissue 
(which helps to better distinguish the brain-non-brain boundary). Missing 
regions can be added manually. This does not have to be done precisely, only 
roughly, and it is better to include too much tissue than too little. The 
procedure should then be rerun as non-linear, but using this weight mask.                     
use_rats_tool:
If <cite>use_rats_tool</cite> is turned on, RATS tool is used for brain extraction
and has to be cited. For more information, see
<a class="reference external" href="http://www.iibi.uiowa.edu/content/rats-overview/">RATS</a></p>
</dd></dl>

<div style='clear:both'></div></div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="sammba.registration.anats_to_template.html" class="btn btn-neutral float-right" title="sammba.registration.anats_to_template" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="sammba.data_fetchers.fetch_masks_dorr_2008.html" class="btn btn-neutral" title="sammba.data_fetchers.fetch_masks_dorr_2008" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, The sammba-MRI developers.

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/copybutton.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>